# 功能分离迁移指南

## 📋 概述

本文档说明了 AI 教学助手系统的功能分离重构，以及对教师和学生用户的影响。

## 🎯 分离原因

为了更好地实现职责分离和系统模块化，我们将系统拆分为两个独立的部分：

1. **学生学习支持系统**（本系统）- 专注于学生学习支持功能
2. **作业管理系统**（外部系统）- 专注于教师端作业管理功能

### 分离的好处

- ✅ **职责清晰**：每个系统专注于自己的核心功能
- ✅ **独立开发**：两个系统可以独立开发和部署
- ✅ **降低耦合**：减少系统间的相互依赖
- ✅ **易于维护**：更小的代码库更容易维护和测试

## 🔄 功能变更

### 已移除的功能（本系统）

以下功能已从本系统中移除，现由外部管理系统负责：

- ❌ 创建作业
- ❌ 编辑作业
- ❌ 删除作业
- ❌ 教师端批量上传学生作业
- ❌ 文件管理器同步功能

### 保留的功能（本系统）

以下功能继续在本系统中提供：

#### 学生端功能
- ✅ 查看作业列表
- ✅ 提交作业
- ✅ 查看评分结果
- ✅ 查看提交历史
- ✅ AI 问答助手

#### 教师端功能
- ✅ 查看作业列表和统计
- ✅ 评分和审核学生提交
- ✅ 查重检测和报告
- ✅ 代码分析和反馈
- ✅ 问题队列管理

## 👨‍🏫 教师用户指南

### 如何创建和管理作业

1. **打开管理系统**
   - 路径：`E:\Code\repo\管理系统`
   - 运行管理系统的启动脚本

2. **创建作业**
   - 在管理系统中创建课程和班级
   - 添加作业任务，设置截止日期
   - 选择作业类型（知识点学习、OJ题目、ACDC系统任务）

3. **同步到学习支持系统**
   - 作业创建后会自动保存到 `data/db.json`
   - 在学习支持系统中点击"同步作业"按钮
   - 或者等待系统自动同步（如果配置了定时任务）

### 作业类型映射

管理系统中的任务类型会自动映射到学习支持系统的作业类型：

| 管理系统任务类型 | 学习支持系统作业类型 |
|-----------------|---------------------|
| 知识点学习 | Essay（论文/报告） |
| OJ题目 | Code（代码） |
| ACDC系统任务 | Code（代码） |

### 教师工作流程

```
1. 在管理系统中创建作业
   ↓
2. 在学习支持系统中同步作业
   ↓
3. 学生在学习支持系统中提交作业
   ↓
4. 系统自动评分和查重
   ↓
5. 教师在学习支持系统中审核评分结果
```

## 👨‍🎓 学生用户指南

### 对学生的影响

**好消息**：学生端功能**完全不受影响**！

- ✅ 继续在同一个系统中查看作业
- ✅ 继续在同一个系统中提交作业
- ✅ 继续在同一个系统中查看成绩
- ✅ 所有历史提交记录都保留

### 学生工作流程

```
1. 登录学习支持系统
   ↓
2. 查看作业列表
   ↓
3. 选择作业并提交代码/报告
   ↓
4. 等待 AI 自动评分
   ↓
5. 查看评分结果和反馈
```

## 🔧 技术细节

### 数据同步机制

**同步方向**：管理系统 → 学习支持系统（单向）

**同步方式**：
- 手动触发：通过 API 端点 `POST /api/v1/sync/assignments`
- 自动同步：可配置定时任务（可选）

**数据源**：
- 管理系统数据文件：`E:\Code\repo\管理系统\data\db.json`

**同步逻辑**：
1. 读取管理系统的 `db.json` 文件
2. 提取所有班级和任务数据
3. 将任务映射为作业（根据类型映射规则）
4. 检查是否已存在（根据 `assignment_id`）
5. 仅创建新作业，跳过已存在的作业
6. 记录同步日志

### 历史数据处理

- ✅ 所有现有的作业数据都保留
- ✅ 所有学生提交记录都保留
- ✅ 所有评分结果都保留
- ✅ 新作业通过同步机制添加

## 🚨 常见问题

### Q1: 我的历史作业数据会丢失吗？
**A**: 不会。所有历史数据都完整保留。

### Q2: 学生需要做什么改变吗？
**A**: 不需要。学生端功能完全不受影响。

### Q3: 如何同步新创建的作业？
**A**: 在教师仪表板点击"同步作业"按钮，或等待自动同步。

### Q4: 同步会覆盖现有数据吗？
**A**: 不会。同步只会添加新作业，不会修改或删除现有数据。

### Q5: 如果同步失败怎么办？
**A**: 查看同步日志（`data/sync_log.json`）了解错误原因，或联系技术支持。

## 📞 技术支持

如有问题，请联系：
- 技术支持邮箱：support@example.com
- 系统管理员：admin@example.com

